1) –¶–µ–ª—å

–ï–¥–∏–Ω—ã–π –∫–æ–Ω–≤–µ–π–µ—Ä: –ø–æ–ª—É—á–∏—Ç—å —á–µ–∫ –∏–∑ –¢–µ–ª–µ–≥—Ä–∞–º–∞ ‚Üí –∏–∑–≤–ª–µ—á—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—è (—Å—É–º–º–∞, –≤–∞–ª—é—Ç–∞, —Ç–∏–ø –æ–ø–µ—Ä–∞—Ü–∏–∏, –∫–∞—Ä—Ç–∞, –æ–ø–µ—Ä–∞—Ç–æ—Ä/–ø—Ä–æ–¥–∞–≤–µ—Ü, –≤—Ä–µ–º—è, –±–∞–ª–∞–Ω—Å‚Äë–ø–æ—Å–ª–µ, –º–µ—Ä—á–∞–Ω—Ç –∏ –ø—Ä.) ‚Üí –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å ‚Üí –¥–µ–¥—É–ø–ª–∏—Ü–∏—Ä–æ–≤–∞—Ç—å ‚Üí –ø–æ–ª–æ–∂–∏—Ç—å –≤ –ë–î –∏ –æ—Ç–¥–∞—Ç—å –≤ UI. –Ø–¥—Ä–æ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è ‚Äî –∞–≥–µ–Ω—Ç –Ω–∞ OpenAI —Å Structured Outputs –∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏‚Äë—Ç—É–ª–∑–∞–º–∏. –î–ª—è –ø–æ—Ç–æ–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π ‚Äî OCR/vision —á–µ—Ä–µ–∑ –º–æ–¥–µ–ª—å —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫–∞—Ä—Ç–∏–Ω–æ–∫. –°—Ç–∞–≤–∫–∞ –Ω–∞ Responses API (—É–ø—Ä–æ—â—ë–Ω–Ω–∞—è –º–æ–¥–µ–ª—å —Ä–∞–±–æ—Ç—ã, –º–∏–≥—Ä–∞—Ü–∏—è —Å Assistants –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ –ø–æ–æ—â—Ä—è–µ—Ç—Å—è). 
platform.openai.com

2) –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (–æ–±–∑–æ—Ä)
[Telegram] -> Ingest Gateway (Webhook) -> Event Bus (NATS/Kafka)
             \-> (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) User Client (TDLib/Telethon)

Event Bus -> Parser Agent Service (OpenAI Responses + Tools)
           -> Normalizer (–æ–ø–µ—Ä–∞—Ç–æ—Ä/–ø—Ä–æ–¥–∞–≤–µ—Ü, –≤–∞–ª—é—Ç–∞, –¥–∞—Ç–∞/–≤—Ä–µ–º—è)
           -> Deduper (LSH/sha1 —Å–∏–≥–Ω–∞—Ç—É—Ä—ã)
           -> Storage: Postgres (OLTP) + Object Store (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)
           -> API (REST/GraphQL) -> Web UI (—Ç–∞–±–ª–∏—Ü–∞, —Ñ–∏–ª—å—Ç—Ä—ã, —ç–∫—Å–ø–æ—Ä—Ç)


–ö–ª—é—á–µ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã:

Ingest Gateway ‚Äî –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –≤–µ–±—Ö—É–∫–∏ –¢–µ–ª–µ–≥—Ä–∞–º–∞, —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç message/update/channel_post, —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç —Å—ã—Ä—ã–µ ¬´—Å–æ–±—ã—Ç–∏—è¬ª –≤ —à–∏–Ω—É.

User Client (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) ‚Äî ¬´–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∫–ª–∏–µ–Ω—Ç¬ª –Ω–∞ TDLib/Telethon –¥–ª—è —á—Ç–µ–Ω–∏—è –ª–∏—á–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –±–∞–Ω–∫–æ–≤—Å–∫–∏–º–∏ –±–æ—Ç–∞–º–∏ (—Å–º. ¬ß3.1 –ø—Ä–æ —Ä–∏—Å–∫–∏).

Parser Agent Service ‚Äî –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ OpenAI Responses API (–º–æ–¥–µ–ª–∏ gpt‚Äë5‚Äëpro –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –∫–µ–π—Å–æ–≤; —ç–∫–æ–Ω–æ–º–∏—á–Ω—ã–µ gpt‚Äë4o‚Äëmini/gpt‚Äë4.1‚Äënano ‚Äî –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–π). –°—Ç—Ä–æ–≥–∞—è JSON‚Äë—Å—Ö–µ–º–∞ —á–µ—Ä–µ–∑ Structured Outputs. 
platform.openai.com
+4
platform.openai.com
+4
platform.openai.com
+4

Normalizer ‚Äî —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É–µ—Ç —á–∏—Å–ª–∞, –≤–∞–ª—é—Ç—ã, –∫–∞—Ä—Ç—ã, –º–∞–ø–ø–∏—Ç ¬´–æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤¬ª –Ω–∞ –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏–µ –∏–º–µ–Ω–∞ –∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ —Å–ª–æ–≤–∞—Ä—é. –ò—Å—Ç–æ—á–Ω–∏–∫ —Å–ª–æ–≤–∞—Ä—è: –≤–∞—à —Ñ–∞–π–ª.

Deduper ‚Äî –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—É—é –∑–∞–ø–∏—Å—å –æ–¥–Ω–æ–≥–æ –∏ —Ç–æ–≥–æ –∂–µ —á–µ–∫–∞.

Storage ‚Äî Postgres (OLTP), –æ–±—ä–µ–∫—Ç—ã (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è/–º–µ–¥–∏–∞) –≤ S3/MinIO; –¥–ª—è LLM‚Äë–∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –º–æ–∂–Ω–æ –ø—Ä–∏–∫–ª–∞–¥—ã–≤–∞—Ç—å —Ñ–∞–π–ª—ã —á–µ—Ä–µ–∑ OpenAI Files –ø—Ä–∏ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö —Ä–∞–∑–±–æ—Ä–∞ PDF/–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π. –î–ª—è PDF/–∫–∞—Ä—Ç–∏–Ω–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã –º—É–ª—å—Ç–∏‚Äë–º–æ–¥–∞–ª—å–Ω—ã–µ –≤—Ö–æ–¥—ã. 
platform.openai.com
+1

3) Telegram: –∏—Å—Ç–æ—á–Ω–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π

3.1. –í–∞—Ä–∏–∞–Ω—Ç A (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–Ω—ã–π, –±–µ–∑ ¬´self‚Äëbot¬ª):
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏/–∏–ª–∏ —Ç—Ä–∏ ¬´–∏–Ω—Ñ–æ—Ä–º–∏—Ä—É—é—â–∏—Ö –±–æ—Ç–∞¬ª –ø—É–±–ª–∏–∫—É—é—Ç –≤ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–∞–Ω–∞–ª. –ù–∞—à –±–æ—Ç‚Äë–∫–æ–ª–ª–µ–∫—Ç–æ—Ä (–Ω–∞—à —Å–µ—Ä–≤–∏—Å–Ω—ã–π –±–æ—Ç) –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∞–¥–º–∏–Ω–æ–º –∏ –ø–æ–ª—É—á–∞–µ—Ç channel_post‚Äë—Å–æ–±—ã—Ç–∏—è –ø–æ Bot API. –≠—Ç–æ –¢OS‚Äë—Å–æ–≤–º–µ—Å—Ç–∏–º–æ; –≤ –±—ç–∫–µ–Ω–¥–µ –º—ã –ø—Ä–∏–Ω–∏–º–∞–µ–º –∞–ø–¥–µ–π—Ç—ã –ø–æ –≤–µ–±—Ö—É–∫—É –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –∏—Ö –≤ —à–∏–Ω—É.

3.2. –í–∞—Ä–∏–∞–Ω—Ç B (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ–¥ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∑–∞–∫–∞–∑—á–∏–∫–∞): ¬´user client¬ª
–ó–∞–ø—É—Å–∫ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–π —Å–µ—Å—Å–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ TDLib/Telethon (user account) –¥–ª—è –∞–≤—Ç–æ‚Äë–ø–µ—Ä–µ—Å—ã–ª–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–æ–≤ —Å –±–∞–Ω–∫–æ–≤—Å–∫–∏–º–∏ –±–æ—Ç–∞–º–∏ –≤ –∫–∞–Ω–∞–ª/–≤–µ–±—Ö—É–∫. –≠—Ç–æ—Ç –ø—É—Ç—å –º–æ–∂–µ—Ç –ø–æ–ø–∞–¥–∞—Ç—å –≤ ¬´—Å–µ—Ä—ãe –∑–æ–Ω—ã¬ª –ø—Ä–∞–≤–∏–ª Telegram. –î–µ–ª–∞–µ–º —Ñ–∏—á—É –º–æ–¥—É–ª—å–Ω–æ–π –∏ –æ—Ç–∫–ª—é—á–∞–µ–º–æ–π —Ñ–ª–∞–≥–æ–º ENV, —è–≤–Ω–æ –æ–±–æ–∑–Ω–∞—á–∞–µ–º —Ä–∏—Å–∫–∏ –≤ –¥–æ–≥–æ–≤–æ—Ä–µ.

4) –°—Ö–µ–º—ã –¥–∞–Ω–Ω—ã—Ö
4.1. –¢–∞–±–ª–∏—Ü—ã (Postgres)

receipts
id bigserial PK
user_id uuid
source_platform text (telegram)
source_chat_id text
message_id text
raw_text text
raw_html text NULL
raw_lang text (ru/uz/en)
event_type text (payment|purchase|p2p|topup|conversion|fee|penalty|other)
amount numeric(18,2)
currency char(3) (UZS|USD|...)
sign smallint (+1 topup, ‚àí1 —Å–ø–∏—Å–∞–Ω–∏–µ)
card_brand text (HUMO|UZCARD|VISA|...)
card_mask text (***6714)
operator_raw text (–Ω–∞–ø—Ä–∏–º–µ—Ä: "OQ P2P>TASHKENT")
operator_id int NULL (FK -> operators.id)
operator_canonical text
merchant_name text NULL
merchant_address text NULL
balance_after numeric(18,2) NULL
balance_currency char(3) NULL
ts_event timestamptz (UTC)
ts_local text (—Å—Ç—Ä–æ–∫–∞ –∫–∞–∫ –≤ —Å–º—Å–∫–µ)
confidence real
duplicate_key text (hash –¥–ª—è –¥–µ–¥—É–ø)
ingest_at timestamptz default now()
parse_status text (ok|needs_review|failed)
error text NULL

operators
id serial PK
pattern text (—Ä–µ–≥—ç–∫—Å–ø/like)
canonical text (–Ω–∞–ø—Ä. "OQ")
app text (–Ω–∞–ø—Ä. "OQ" / "MyUztelecom" / "Humans" –∏ —Ç. –ø.)
weight int default 1
notes text NULL

attachments
id bigserial PK
receipt_id bigint FK
type text (photo|pdf|video|voice|file)
file_bucket text
file_key text
sha256 text
ocr_text text NULL

cards
id serial PK
user_id uuid
mask text
brand text
issuer text NULL

–ò–Ω–¥–µ–∫—Å—ã: (user_id, ts_event desc), duplicate_key unique nulls not distinct, GIN –ø–æ raw_text (full‚Äëtext).

4.2. –°–æ–±—ã—Ç–∏—è (–≤ —à–∏–Ω–µ)

telegram.message.raw: —Å—ã—Ä—ã–µ –∞–ø–¥–µ–π—Ç—ã Bot API, payload: {update_id, message || channel_post, ...}

receipt.candidate: {source, raw_text, media_refs[], user_id?, received_at}

receipt.parsed: –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π JSON –ø–æ —Å—Ö–µ–º–µ (–Ω–∏–∂–µ)

receipt.persisted: {receipt_id, status}

4.3. –°—Ö–µ–º–∞ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ —á–µ–∫–∞ (JSON Schema)
{
  "type": "object",
  "required": ["event_type","amount","currency","ts_event","sign"],
  "properties": {
    "event_type": {"type":"string","enum":["payment","purchase","p2p","topup","conversion","fee","penalty","other"]},
    "amount": {"type":"number"},
    "currency": {"type":"string","minLength":3,"maxLength":3},
    "sign": {"type":"integer","enum":[-1,1]},
    "card_brand": {"type":"string"},
    "card_mask": {"type":"string"},
    "operator_raw": {"type":"string"},
    "operator_canonical": {"type":"string"},
    "operator_app": {"type":"string"},
    "merchant_name": {"type":"string"},
    "merchant_address": {"type":"string"},
    "balance_after": {"type":"number"},
    "balance_currency": {"type":"string","minLength":3,"maxLength":3},
    "ts_event": {"type":"string","format":"date-time"},
    "tz_hint": {"type":"string"},
    "lang": {"type":"string"},
    "confidence": {"type":"number"}
  }
}


–≠—Ç–∞ —Å—Ö–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ Structured Outputs: –º–æ–¥–µ–ª—å –æ–±—è–∑–∞–Ω–∞ –≤–µ—Ä–Ω—É—Ç—å —Ä–æ–≤–Ω–æ —Ç–∞–∫–æ–π JSON. 
platform.openai.com

5) –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å OpenAI
5.1. –ü–æ—á–µ–º—É Responses API –∏ –∫–∞–∫ (–≤–º–µ—Å—Ç–æ Assistants)

–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ –æ–±—ä—è–≤–ª–µ–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è –∫ Responses API –∫–∞–∫ –±–æ–ª–µ–µ –ø—Ä–æ—Å—Ç–æ–º—É –∏ –≥–∏–±–∫–æ–º—É —É—Ä–æ–≤–Ω—é; –æ–Ω –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç structured JSON, —Å—Ç—Ä–∏–º–∏–Ω–≥ –∏ —Ç—É–ª—ã. –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º Responses –∫–∞–∫ ¬´–¥–≤–∏–∂–æ–∫¬ª –∞–≥–µ–Ω—Ç–∞, —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –Ω–∞—à–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π. 
platform.openai.com
+1

5.2. –ú–æ–¥–µ–ª–∏ –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è

gpt‚Äë5‚Äëpro ‚Äî –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö, —à—É–º–Ω—ã—Ö, –º—É–ª—å—Ç–∏—è–∑—ã—á–Ω—ã—Ö —á–µ–∫–æ–≤/–∫–∞—Ä—Ç–∏–Ω–æ–∫ –∏ ¬´—Ç—è–∂—ë–ª–æ–π¬ª –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ (–≤ —Ç. —á. –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑ —Ñ–æ—Ç–æ). 
platform.openai.com

gpt‚Äë4o‚Äëmini / gpt‚Äë4.1‚Äënano ‚Äî –±—ã—Å—Ç—Ä—ã–µ/–¥–µ—à—ë–≤—ã–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏: —Ç–∏–ø —Å–æ–±—ã—Ç–∏—è, –¥–µ—Ç–µ–∫—Ç –≤–∞–ª—é—Ç—ã, –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ (pre‚Äëpass). 
platform.openai.com
+1

Vision/PDF –ø–æ—Ç–æ–∫ ‚Äî —á–µ—Ä–µ–∑ –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã–µ –≤—Ö–æ–¥—ã —Ñ–∞–π–ª–æ–≤/–∫–∞—Ä—Ç–∏–Ω–æ–∫. 
platform.openai.com
+1

5.3. –¢—É–ª—ã –∞–≥–µ–Ω—Ç–∞ (function‚Äëcalling)

tool:extract_receipt ‚Äî –ø—Ä–∏–Ω–∏–º–∞–µ—Ç raw_text/ocr_text/language_hint ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç –ø–æ JSON‚Äë—Å—Ö–µ–º–µ (—Å–º. ¬ß4.3).

tool:normalize_operator ‚Äî –Ω–∞ –≤—Ö–æ–¥–µ operator_raw, –Ω–∞ –≤—ã—Ö–æ–¥–µ {canonical, app} –ø–æ —Å–ª–æ–≤–∞—Ä—é (—Å–º. –Ω–∏–∂–µ).

tool:upsert_db ‚Äî –ø–∏—Å–∞—Ç–µ–ª—å (—Ç–æ–Ω–∫–∏–π –∞–¥–∞–ø—Ç–µ—Ä –∫ Postgres), –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏.

tool:dedupe_check ‚Äî –≤—ã—á–∏—Å–ª—è–µ—Ç duplicate_key (—Ö—ç—à –Ω–∞ {amount, ts ¬±60s, card_mask?, operator_canonical, sign} + —Ö—ç—à raw_text).

–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –≤ Responses/Tools –º–æ–∂–Ω–æ –æ–±—ä—è–≤–ª—è—Ç—å –∫–∞–∫ —Å—Ç—Ä–æ–≥–∏–µ JSON‚Äë—Å—Ö–µ–º—ã –¥–ª—è structured outputs, —Ç–∞–∫ –∏ ¬´–∫–∞—Å—Ç–æ–º–Ω—ã–µ¬ª –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–≥–æ –≤–≤–æ–¥–∞/–≤—ã–≤–æ–¥–∞, —á—Ç–æ —É–¥–æ–±–Ω–æ –¥–ª—è –Ω–∞—à–∏—Ö –ë–î‚Äë—Ç—É–ª–æ–≤. 
platform.openai.com
+1

5.4. –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ (–ø—Å–µ–≤–¥–æ‚Äëcurl)
curl https://api.openai.com/v1/responses \
 -H "Authorization: Bearer $OPENAI_API_KEY" \
 -H "Content-Type: application/json" \
 -d '{
   "model": "gpt-5-pro",
   "input": [{"role":"user","content":[{"type":"input_text","text": "...—Å—ã—Ä–æ–π —Ç–µ–∫—Å—Ç —á–µ–∫–∞..."}]}],
   "response_format": {
     "type":"json_schema",
     "json_schema": { ... –∏–∑ ¬ß4.3 ... }
   },
   "tools": [
     {"type":"custom","name":"normalize_operator", "description":"maps raw operator string..."},
     {"type":"custom","name":"dedupe_check"},
     {"type":"custom","name":"upsert_db"}
   ]
 }'


–°—Ç—Ä–∏–º–∏–Ω–≥/—Ä–µ–∞–∫—Ü–∏–∏ –¥–æ—Å—Ç—É–ø–Ω—ã, –Ω–æ –¥–ª—è –ø–∞–∫–µ—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Batch API. 
platform.openai.com

5.5. Batch –∏ –æ—Ñ—Ñ–ª–∞–π–Ω‚Äë–æ–±—Ä–∞–±–æ—Ç–∫–∞

–î–ª—è –æ—á–µ—Ä–µ–¥–µ–π –±—ç–∫—Ñ–∏–ª–ª–∞ (–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ —á–∞—Ç—ã, –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª) ‚Äî Batch API. 
platform.openai.com

5.6. Actions/–¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º

–î–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –ë–î/–∏–Ω–¥–µ–∫—Å–∞–º –º–æ–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —á–µ—Ä–µ–∑ ¬´GPT Actions / data retrieval¬ª: –æ–ø–∏—Å—ã–≤–∞–µ–º —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, ACL. –í –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π internal API —Å–ª–æ–π, –∞–≥–µ–Ω—Ç –≤—ã–∑—ã–≤–∞–µ—Ç upsert_db/lookup_operator –∫–∞–∫ action. 
platform.openai.com

5.7. –ö–∞—á–µ—Å—Ç–≤–æ –∏ —Ç–æ–Ω–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

–ï—Å–ª–∏ –ø–æ—Å–ª–µ –≤–≤–æ–¥–∞ –ø—Ä–∞–≤–∏–ª –∏ Structured Outputs –æ—Å—Ç–∞—é—Ç—Å—è —á–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏ –≤ –∏–∑–≤–ª–µ—á–µ–Ω–∏–∏ ‚Äî –≥–æ—Ç–æ–≤–∏–º –Ω–µ–±–æ–ª—å—à–æ–π –¥–∞—Ç–∞—Å–µ—Ç –∏ –¥–µ–ª–∞–µ–º SFT/—Ç–æ–Ω–∫—É—é –ø–æ–¥—Å—Ç—Ä–æ–π–∫—É –ø–æ–¥ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —á–µ–∫–æ–≤. 
platform.openai.com
+1

6) –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤/–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

–ë–∞–∑–æ–≤—ã–π —Å–ª–æ–≤–∞—Ä—å –æ–ø–µ—Ä–∞—Ç–æ—Ä‚Üí–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±–µ—Ä—ë–º –∏–∑ –≤–∞—à–µ–≥–æ —Ñ–∞–π–ª–∞ –∏ —Ö—Ä–∞–Ω–∏–º –≤ operators + YAML —Ä—è–¥–æ–º —Å –∫–æ–¥–æ–º. –ü—Ä–∏–º–µ—Ä –∫—É—Å–∫–∞ operators.yml:

- pattern: "OQ P2P(>.*)?|\\bOQ\\b"
  canonical: "OQ"
  app: "OQ"
- pattern: "NBU P2P HUMO UZCARD>|NBU ONLINE KONVERSIY|NBU 2P2 U PLAT UZCARD"
  canonical: "NBU"
  app: "Milliy 2.0"
- pattern: "SQB MOBILE HUMO P2P|SQB MOBILE UZCARD P2P UZCARD"
  canonical: "SQB MOBILE P2P"
  app: "SQB"
- pattern: "XAZNA.*|XAZNA PAYNET TOLOV"
  canonical: "XAZNA"
  app: "Xazna"
# ...


–û—Å–Ω–æ–≤–∞–Ω–æ –Ω–∞ –≤–∞—à–µ–º —Å–ª–æ–≤–∞—Ä–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤/–ø—Ä–æ–¥–∞–≤—Ü–æ–≤ –∏ –∏—Ö –ø—Ä–∏–≤—è–∑–∫–µ –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º. –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ ‚Äî –≤ —Ñ–∞–π–ª–µ –ø—Ä–æ–µ–∫—Ç–∞ (—Å–º. –∏—Å—Ç–æ—á–Ω–∏–∫).

7) –†–∞–∑–±–æ—Ä –ø—Ä–∏–º–µ—Ä–æ–≤ –∏ —Ç–µ—Å—Ç‚Äë–Ω–∞–±–æ—Ä

–ë–µ—Ä—ë–º –≤–∞—à–∏ —Ä–µ–∞–ª—å–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (—Ä—É—Å/—É–∑–±) –∫–∞–∫ golden set –¥–ª—è –∞–≤—Ç–æ—Ç–µ—Å—Ç–æ–≤ –∏ —ç–≤–∞–ª–æ–≤. –ù–∏–∂–µ ‚Äî –ø—Ä–∏–º–µ—Ä—ã –ø–æ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –∏–∑–≤–ª–µ–∫–∞—Ç—å—Å—è —Å—Ç–∞–±–∏–ª—å–Ω–æ:

HUMOCARD *6714: oplata 6000000.00 UZS; NBU P2P HUMO UZCARD>; 25-04-04 18:46; Dostupno: 935000.40 UZS
‚Üí event_type=payment, amount=6000000, currency=UZS, card_mask=*6714, operator_raw=NBU P2P HUMO UZCARD>, operator_canonical=NBU, operator_app=Milliy 2.0, balance_after=935000.40, ts_event=2025-04-04T18:46:00+05:00.

üî¥ Spisanie c karty ‚ûñ 351 750.00 UZS ... UZCARD OTHERS 2 ANY PAYNET, 99 ...
‚Üí event_type=fee|payment (–≤ –∑–∞–≤–∏—Å. –æ—Ç –ø–æ–ª–∏—Ç–∏–∫–∏), operator_canonical=PAYNET.

üí∏ –ö–æ–Ω–≤–µ—Ä—Å–∏—è ‚ûñ 1 100.90 USD ...
‚Üí event_type=conversion, amount=1100.90, currency=USD, sign=-1.

–£–∑–±–µ–∫—Å–∫–∏–π/—Ä—É—Å—Å–∫–∏–π –º–∏–∫—Å, –≤–∞—Ä–∏–∞—Ü–∏–∏ —Å –∑–∞–ø—è—Ç—ã–º–∏ 10.035.000,00 UZS ‚Äî –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ–º –∫ 10035000.00.

–≠—Ç–∏ –∫–µ–π—Å—ã –≤–∫–ª—é—á–∏—Ç—å –≤ tests/evals/receipts_golden.jsonl –∏ –≤ –ø–∞–π–ø–ª–∞–π–Ω —ç–≤–∞–ª–æ–≤. –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π –≥–∞–π–¥ –ø–æ —ç–≤–∞–ª–∞–º ‚Äî —Ç—É—Ç. 
platform.openai.com

8) –î–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è

sig1 = sha1(lower(raw_text_clean))

sig2 = sha1(amount|currency|card_mask|operator_canonical|sign|floor(ts_event/60s))
–°–æ–≤–ø–∞–¥–µ–Ω–∏–µ –æ–¥–Ω–æ–π –∏–∑ —Å–∏–≥–Ω–∞—Ç—É—Ä ‚Üí –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –¥—É–±–ª–∏–∫–∞—Ç; –µ—Å–ª–∏ message_id —Å–æ–≤–ø–∞–¥–∞–µ—Ç ‚Äî —Ç–æ—á–Ω–æ –¥—É–±–ª–∏–∫–∞—Ç. –õ–æ–≥–∏–∫–∞ –≤ dedupe_check.

9) –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —á–µ–∫–æ–≤

–ï—Å–ª–∏ –≤ Telegram –ø—Ä–∏—Ö–æ–¥—è—Ç —Ñ–æ—Ç–æ/PDF —á–µ–∫–æ–≤ ‚Äî —Å–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª –∏ –≥–æ–Ω–∏–º —á–µ—Ä–µ–∑ vision‚Äë–≤—Ö–æ–¥ —Å –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ–º —Ç–µ—Ö –∂–µ –ø–æ–ª–µ–π –ø–æ JSON‚Äë—Å—Ö–µ–º–µ. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π/—Å—Ç—Ä–∞–Ω–∏—Ü –æ–ø–∏—Å–∞–Ω–∞ –≤ –æ—Ñ. –¥–æ–∫–∞—Ö. 
platform.openai.com
+1

10) API –¥–ª—è —Ñ—Ä–æ–Ω—Ç–∞

GET /api/receipts?filters... (–ø–∞–≥–∏–Ω–∞—Ü–∏—è, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ ts_event)

GET /api/receipts/{id} (–¥–µ—Ç–∞–ª–∏, —Å—Å—ã–ª–∫–∞ –Ω–∞ –≤–ª–æ–∂–µ–Ω–∏—è)

POST /api/reparse/{id} (–ø–µ—Ä–µ–æ–±—Ä–∞–±–æ—Ç–∫–∞)

GET /api/operators (–¥–ª—è —Ñ–∏–ª—å—Ç—Ä–æ–≤)

11) –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ —Å–µ–∫—å—é—Ä–Ω—ã–π –ø–µ—Ä–∏–º–µ—Ç—Ä

–°–µ–∫—Ä–µ—Ç—ã –≤ Vault/Secrets Manager, —Ç–æ–∫–µ–Ω—ã Telegram/OpenAI –≤ ENV.

–í–µ–±—Ö—É–∫ –¢–µ–ª–µ–≥—Ä–∞–º–∞ ‚Äî —Å–æ —Å–∫—Ä—ã—Ç—ã–º URL + –ø—Ä–æ–≤–µ—Ä–∫–∞ IP/–ø–æ–¥–ø–∏—Å–∏.

PII —à–∏—Ñ—Ä–æ–≤–∞—Ç—å at rest (pgcrypto) –∏ –≤ –æ–±—ä–µ–∫—Ç–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (SSE‚ÄëS3).

–†–æ–ª–µ–≤–∞—è –º–æ–¥–µ–ª—å (RBAC): –≤–ª–∞–¥–µ–ª–µ—Ü –¥–∞–Ω–Ω—ã—Ö –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ —á–µ–∫–∏.

12) –ü—Ä–æ–¥–∞–∫—à–Ω –ø—Ä–∞–∫—Ç–∏–∫–∏

–†–µ—Ç—Ä–∞–π‚Äë–ø–æ–ª–∏—Ç–∏–∫–∞ –Ω–∞ –≤—Å—Ç–∞–≤–∫—É/–≤—ã–∑–æ–≤—ã API, –∏–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –ø–æ duplicate_key.

–ú–µ—Ç—Ä–∏—á–∫–∏: –≤—Ä–µ–º—è –ø–∞—Ä—Å–∏–Ω–≥–∞, % structured‚Äë–≤–∞–ª–∏–¥–Ω—ã—Ö, CER (classification error rate), CTR (conversion extract rate).

–õ–∏–º–∏—Ç—ã/–∫—ç—à: –ø—Ä–æ–º–ø—Ç‚Äë–∫—ç—à, —Ä–æ—É—Ç–∏–Ω–≥ –Ω–∞ –º–µ–Ω—å—à–∏–µ –º–æ–¥–µ–ª–∏. –õ—É—á—à–∏–µ –ø—Ä–æ–¥‚Äë–ø—Ä–∞–∫—Ç–∏–∫–∏ ‚Äî –≤ –≥–∞–π–¥–µ. 
platform.openai.com

13) –ë—ç–∫–ª–æ–≥ (MVP ‚Üí V2)

[MVP] –ö–∞–Ω–∞–ª ‚Üí –ø–∞—Ä—Å–µ—Ä ‚Üí —Ç–∞–±–ª–∏—Ü–∞; –±–∞–∑–æ–≤–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤.

[MVP] –î–µ–¥—É–ø; —Ä—É—á–Ω–∞—è –ø–µ—Ä–µ–æ–±—Ä–∞–±–æ—Ç–∫–∞.

[V2] –ò–º–ø–æ—Ä—Ç –∏—Å—Ç–æ—Ä–∏–∏ (Batch). 
platform.openai.com

[V2] –°–≤–æ–¥–Ω—ã–µ –æ—Ç—á—ë—Ç—ã, —ç–∫—Å–ø–æ—Ä—Ç CSV/XLSX.

[V2] –¢–æ–Ω–∫–∞—è –ø–æ–¥—Å—Ç—Ä–æ–π–∫–∞ –º–æ–¥–µ–ª–∏ –ø–æ–¥ –≤–∞—à–∏ —á–µ–∫–∏.