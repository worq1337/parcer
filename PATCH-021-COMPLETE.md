# patch-021: Auto-Updates —á–µ—Ä–µ–∑ GitHub Releases ‚úÖ COMPLETE

## –°—Ç–∞—Ç—É—Å: –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∏ –≥–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –¥–ª—è Electron-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ GitHub Releases.

---

## ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. GitHub Release —Å–æ–∑–¥–∞–Ω –∏ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω

**–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:** https://github.com/worq1337/parcer
**Release:** https://github.com/worq1337/parcer/releases/tag/v1.0.0

**–§–∞–π–ª—ã –≤ Release (4 —à—Ç):**
- `Receipt Parser Setup 1.0.0.exe` - –£—Å—Ç–∞–Ω–æ–≤—â–∏–∫ NSIS (189 MB)
- `Receipt Parser 1.0.0.exe` - –ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω–∞—è –≤–µ—Ä—Å–∏—è (97 MB)
- `latest.yml` - –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–ª—è electron-updater
- `Receipt Parser Setup 1.0.0.exe.blockmap` - –î–ª—è delta-updates

### 2. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞

**`client/package.json`:**
```json
"publish": {
  "provider": "github",
  "owner": "worq1337",
  "repo": "parcer"
}
```

**`client/electron/main.js`:**
```javascript
// patch-021: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π (GitHub Releases)
autoUpdater.setFeedURL({
  provider: 'github',
  owner: 'worq1337',
  repo: 'parcer',
});
```

### 3. Backend –ø–æ—á–∏—â–µ–Ω

–£–¥–∞–ª—ë–Ω –Ω–µ–Ω—É–∂–Ω—ã–π –∫–æ–¥ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–π —Ä–∞–∑–¥–∞—á–∏ —Ñ–∞–π–ª–æ–≤ –∏–∑ `backend/src/index.js`:
- –£–¥–∞–ª—ë–Ω —Ä–æ—É—Ç `/updates`
- –£–¥–∞–ª—ë–Ω endpoint `/api/compat`
- –£–¥–∞–ª—ë–Ω `require('path')`

–û–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è Electron-–∫–ª–∏–µ–Ω—Ç–∞, backend –æ—Å—Ç–∞—ë—Ç—Å—è –Ω–∞ VPS –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π.

### 4. –§–∏–Ω–∞–ª—å–Ω–∞—è —Å–±–æ—Ä–∫–∞ —Å–æ–∑–¥–∞–Ω–∞

**–°–æ–±—Ä–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤:** `/Users/kulacidmyt/Documents/–ø—Ä–æ–µ–∫—Ç—ã /–ø–∞—Ä—Å–µ—Ä –∫–ª–æ–¥/client/dist/`

- ‚úÖ `Receipt Parser Setup 1.0.0.exe` - –£—Å—Ç–∞–Ω–æ–≤—â–∏–∫ (189 MB)
- ‚úÖ `Receipt Parser 1.0.0.exe` - –ü–æ—Ä—Ç–∞—Ç–∏–≤–Ω–∞—è –≤–µ—Ä—Å–∏—è (97 MB)
- ‚úÖ `latest.yml` - –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
- ‚úÖ `Receipt Parser Setup 1.0.0.exe.blockmap` - Blockmap

---

## üéØ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

### –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

1. **–ß–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã** –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç GitHub Release
2. Electron-updater —á–∏—Ç–∞–µ—Ç —Ñ–∞–π–ª: `https://github.com/worq1337/parcer/releases/download/v1.0.0/latest.yml`
3. –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –≤–µ—Ä—Å–∏—é –≤ `latest.yml` (1.0.0) —Å —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–µ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (1.0.0)
4. –ï—Å–ª–∏ –≤–µ—Ä—Å–∏—è –Ω–∞ GitHub –Ω–æ–≤–µ–µ - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ

### –õ–æ–≥–∏ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:

–õ–æ–≥–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤:
- **Windows:** `%USERPROFILE%\AppData\Roaming\Receipt Parser\logs\main.log`
- **macOS:** `~/Library/Logs/Receipt Parser/main.log`

–ú–æ–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å DevTools (View ‚Üí Toggle Developer Tools) –∏ —Å–º–æ—Ç—Ä–µ—Ç—å –∫–æ–Ω—Å–æ–ª—å.

---

## üì¶ –î–µ–ø–ª–æ–π –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏ (–¥–ª—è –±—É–¥—É—â–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π)

### –®–∞–≥ 1: –û–±–Ω–æ–≤–∏—Ç—å –≤–µ—Ä—Å–∏—é –≤ package.json

```bash
cd client
# –ò–∑–º–µ–Ω–∏—Ç—å "version": "1.0.0" ‚Üí "1.0.1" (–∏–ª–∏ 1.1.0, 2.0.0 –∏ —Ç.–¥.)
```

### –®–∞–≥ 2: –°–æ–±—Ä–∞—Ç—å –Ω–æ–≤—É—é –≤–µ—Ä—Å–∏—é

```bash
cd client
npm run build
npx electron-builder --win --x64 -p never
```

### –®–∞–≥ 3: –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π Release –Ω–∞ GitHub

```bash
cd client/dist

# –ß–µ—Ä–µ–∑ gh CLI (—Ç—Ä–µ–±—É–µ—Ç—Å—è GitHub token)
GITHUB_TOKEN="—Ç–≤–æ–π_—Ç–æ–∫–µ–Ω" gh release create v1.0.1 \
  --repo worq1337/parcer \
  --title "Receipt Parser v1.0.1" \
  --notes "–û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π" \
  "latest.yml" \
  "Receipt Parser Setup 1.0.1.exe" \
  "Receipt Parser 1.0.1.exe" \
  "Receipt Parser Setup 1.0.1.exe.blockmap"
```

**–ò–ª–∏ –≤—Ä—É—á–Ω—É—é:**
1. –û—Ç–∫—Ä–æ–π https://github.com/worq1337/parcer/releases/new
2. Tag: `v1.0.1`, Title: `Receipt Parser v1.0.1`
3. –ü–µ—Ä–µ—Ç–∞—â–∏ 4 —Ñ–∞–π–ª–∞ –∏–∑ `client/dist/`
4. –ù–∞–∂–º–∏ **Publish release**

### –®–∞–≥ 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –£—Å—Ç–∞–Ω–æ–≤–∏ —Å—Ç–∞—Ä—É—é –≤–µ—Ä—Å–∏—é (1.0.0) –Ω–∞ Windows –º–∞—à–∏–Ω—É
2. –ó–∞–ø—É—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
3. –ß–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã –ø–æ—è–≤–∏—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –¥–æ—Å—Ç—É–ø–Ω–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
4. –ù–∞–∂–º–∏ "Download Update"
5. –ü–æ—Å–ª–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –Ω–∞–∂–º–∏ "Install and Restart"

---

## üîß Troubleshooting

### –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
**–†–µ—à–µ–Ω–∏–µ:** –£–±–µ–¥–∏—Å—å —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ –≤ production —Ä–µ–∂–∏–º–µ (–Ω–µ –≤ dev)

```javascript
// main.js –ø—Ä–æ–≤–µ—Ä—è–µ—Ç app.isPackaged
if (app.isPackaged) {
  setTimeout(() => {
    autoUpdater.checkForUpdates();
  }, 3000);
}
```

### –û—à–∏–±–∫–∞ 404 –ø—Ä–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** electron-updater –Ω–µ –º–æ–∂–µ—Ç –Ω–∞–π—Ç–∏ —Ñ–∞–π–ª
**–ü—Ä–∏—á–∏–Ω–∞:** –ò–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ –≤ `latest.yml` –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å –∏–º–µ–Ω–∞–º–∏ –Ω–∞ GitHub

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ —Ç–æ—á–Ω–æ —Å–æ–≤–ø–∞–¥–∞—é—Ç:
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å latest.yml
curl https://github.com/worq1337/parcer/releases/download/v1.0.0/latest.yml

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å .exe
curl -I "https://github.com/worq1337/parcer/releases/download/v1.0.0/Receipt%20Parser%20Setup%201.0.0.exe"
```

### –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

**–ü—Ä–æ–±–ª–µ–º–∞:** –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∫–∞—á–∞–ª–æ—Å—å –Ω–æ –Ω–µ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è
**–†–µ—à–µ–Ω–∏–µ:** –£–±–µ–¥–∏—Å—å —á—Ç–æ:
1. `autoUpdater.autoInstallOnAppQuit = true` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ
2. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è (–Ω–µ –≤–∏—Å–∏—Ç –≤ —Ç—Ä–µ–µ)
3. –£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å—Ç—å –ø—Ä–∞–≤–∞ –Ω–∞ –∑–∞–ø–∏—Å—å –≤ `C:\Program Files\`

### –ö–∞—Å—Ç–æ–º–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π (—á–µ—Ä–µ–∑ –º–µ–Ω—é)

–î–æ–±–∞–≤—å –≤ –º–µ–Ω—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

```javascript
// main.js - –≤ menuTemplate
{
  label: '–°–ø—Ä–∞–≤–∫–∞',
  submenu: [
    {
      label: '–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è',
      click: () => {
        if (!app.isPackaged) {
          dialog.showMessageBox(mainWindow, {
            type: 'info',
            message: '–û–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç–∫–ª—é—á–µ–Ω—ã –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏'
          });
          return;
        }
        autoUpdater.checkForUpdates();
      }
    }
  ]
}
```

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

GitHub –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å—á–∏—Ç–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∫–∞—á–∏–≤–∞–Ω–∏–π –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–π–ª–∞ –≤ Release:
- –û—Ç–∫—Ä–æ–π https://github.com/worq1337/parcer/releases/tag/v1.0.0
- –ü–æ–¥ –∫–∞–∂–¥—ã–º —Ñ–∞–π–ª–æ–º –≤–∏–¥–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∫–∞—á–∏–≤–∞–Ω–∏–π

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ü–æ–¥–ø–∏—Å–∞–Ω–∏–µ –∫–æ–¥–∞ (Code Signing)

–¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è **–ù–ï** –ø–æ–¥–ø–∏—Å–∞–Ω–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–º. Windows Defender –º–æ–∂–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ "Unknown Publisher" –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ.

**–î–ª—è production —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:**
1. –ö—É–ø–∏—Ç—å —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ –∫–æ–¥–∞ (Code Signing Certificate)
2. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å electron-builder –¥–ª—è –ø–æ–¥–ø–∏—Å–∏:
   ```json
   "win": {
     "certificateFile": "path/to/cert.pfx",
     "certificatePassword": "password"
   }
   ```

### –û—Ç–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏

–í `client/package.json` —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ:
```json
"win": {
  "verifyUpdateCodeSignature": false
}
```

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–¥–ø–∏—Å–∏.

---

## üìù –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- **electron-updater docs:** https://www.electron.build/auto-update
- **GitHub Releases API:** https://docs.github.com/en/rest/releases
- **electron-builder:** https://www.electron.build/

---

## ‚ú® –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **–£—Å—Ç–∞–Ω–æ–≤–∏ —Å–æ–±—Ä–∞–Ω–Ω—ã–π .exe** –Ω–∞ Windows –º–∞—à–∏–Ω—É
2. **–ó–∞–ø—É—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ**
3. **–û—Ç–∫—Ä–æ–π DevTools** (View ‚Üí Toggle Developer Tools)
4. **–ü—Ä–æ–≤–µ—Ä—å –∫–æ–Ω—Å–æ–ª—å** –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –ª–æ–≥–æ–≤:
   ```
   Checking for updates...
   Update not available: {version: "1.0.0"}
   ```

–ï—Å–ª–∏ –≤–∏–¥–∏—à—å —ç—Ç–∏ –ª–æ–≥–∏ - –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç! üéâ

---

## üöÄ –ò—Ç–æ–≥

‚úÖ GitHub Release —Å–æ–∑–¥–∞–Ω –∏ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω
‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞
‚úÖ Backend –ø–æ—á–∏—â–µ–Ω –æ—Ç –Ω–µ–Ω—É–∂–Ω–æ–≥–æ –∫–æ–¥–∞
‚úÖ –§–∏–Ω–∞–ª—å–Ω—ã–µ .exe —Ñ–∞–π–ª—ã —Å–æ–±—Ä–∞–Ω—ã
‚úÖ –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –∏ –≥–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

**–ì–æ—Ç–æ–≤–æ –∫ –ø–µ—Ä–µ–¥–∞—á–µ –∫–ª–∏–µ–Ω—Ç—É!**

–§–∞–π–ª—ã –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏:
- `Receipt Parser Setup 1.0.0.exe` (—É—Å—Ç–∞–Ω–æ–≤—â–∏–∫)
- `Receipt Parser 1.0.0.exe` (–ø–æ—Ä—Ç–∞—Ç–∏–≤–Ω–∞—è –≤–µ—Ä—Å–∏—è)

–ö–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ª—é–±—É—é –∏–∑ –¥–≤—É—Ö –≤–µ—Ä—Å–∏–π - –æ–±–µ –±—É–¥—É—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –Ω–æ–≤—ã—Ö —Ä–µ–ª–∏–∑–æ–≤.
